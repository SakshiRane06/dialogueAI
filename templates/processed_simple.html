{% extends "base.html" %}

{% block title %}DialogueAI - Document Processed{% endblock %}

{% block content %}
<div class="card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; color: var(--success-color); margin-bottom: 1rem;">
            <i class="fas fa-check-circle"></i>
        </div>
        <h2 style="color: var(--text-primary); font-weight: 600;">
            Document Successfully Processed!
        </h2>
        <p style="color: var(--text-secondary); font-size: 1.1rem;">
            <strong>{{ filename }}</strong> has been analyzed and is ready for dialogue generation.
        </p>
    </div>
    
    <div class="stats">
        <div class="stat-item">
            <div class="stat-value">{{ stats.characters | default(0) | round | int }}</div>
            <div class="stat-label">Characters</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ stats.chunks | default(0) }}</div>
            <div class="stat-label">Text Chunks</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ stats.embedding_model | truncate(12, True) | default('N/A') }}</div>
            <div class="stat-label">Embedding Model</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">
                {% if stats.using_openai %}
                    <i class="fas fa-robot" style="color: var(--primary-color);"></i>
                {% else %}
                    <i class="fas fa-cog" style="color: var(--warning-color);"></i>
                {% endif %}
            </div>
            <div class="stat-label">
                {% if stats.using_openai %}OpenAI{% else %}Local Model{% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card">
    <h3 style="margin-bottom: 2rem; color: var(--text-primary); text-align: center;">
        <i class="fas fa-magic"></i> Generate Your Dialogue
    </h3>
    
    <!-- SIMPLE FORM WITHOUT JAVASCRIPT -->
    <form action="/generate" method="post">
        <!-- Hidden fields to pass document info -->
        <input type="hidden" name="file_id" value="{{ file_id }}">
        <input type="hidden" name="filename" value="{{ filename }}">
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-bullseye"></i> What do you want to learn from this document?
            </label>
            <textarea 
                name="user_goal" 
                class="form-control" 
                placeholder="e.g., 'Explain RAG like a podcast' or 'Help me understand the key concepts'"
                rows="3"
                required
                style="resize: vertical; min-height: 80px;"
            >Explain RAG like a podcast</textarea>
            <small style="color: var(--text-secondary); font-size: 0.85rem;">
                Be specific about what you'd like to learn or understand from the document.
            </small>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-volume-up"></i> Conversation Tone
                </label>
                <select name="tone" class="form-control">
                    <option value="conversational">Conversational</option>
                    <option value="professional">Professional</option>
                    <option value="casual">Casual</option>
                    <option value="academic">Academic</option>
                    <option value="friendly">Friendly</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-graduation-cap"></i> Difficulty Level
                </label>
                <select name="difficulty" class="form-control">
                    <option value="beginner">Beginner</option>
                    <option value="intermediate" selected>Intermediate</option>
                    <option value="advanced">Advanced</option>
                    <option value="expert">Expert</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-robot"></i> AI Provider
                </label>
                <select name="provider" class="form-control">
                    <option value="puter" selected>Puter.js (Free)</option>
                    <option value="auto">Auto (Best Available)</option>
                    <option value="google">Google Gemini</option>
                </select>
                <small style="color: var(--text-secondary); font-size: 0.75rem;">
                    Puter.js provides intelligent dialogue generation
                </small>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn">
                <i class="fas fa-comments"></i>
                Generate Dialogue (No JS)
            </button>
        </div>
    </form>
</div>

<div style="text-align: center; margin-top: 2rem;">
    <a href="/" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i>
        Upload Another Document
    </a>
</div>

<script>
// Simple auto-focus without complex JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const goalTextarea = document.querySelector('textarea[name="user_goal"]');
    if (goalTextarea) {
        goalTextarea.focus();
    }
});
</script>
{% endblock %}
